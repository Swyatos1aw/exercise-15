import pandas as pd
import matplotlib.pyplot as plt


fixed_df = pd.read_csv(
    "C:/test/velo.csv",  
    sep=',',
    encoding='latin1',
    parse_dates=['Date'], 
    dayfirst=True,  
    index_col='Date')

print(fixed_df.head(365))

fixed_df.plot()
plt.title('–ú—ñ—Å—è—á–Ω—ñ –¥–∞–Ω—ñ –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–∏—Ö –ø–æ—ó–∑–¥–æ–∫')
plt.show()
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∏–ø—É —ñ–Ω–¥–µ–∫—Å—É,—â–æ —Ü–µ DatetimeIndex
if not isinstance(fixed_df.index, pd.DatetimeIndex):
    fixed_df.index = pd.to_datetime(fixed_df.index)

# –°—É–º—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ –º—ñ—Å—è—Ü—è–º
monthly_data = fixed_df.resample('ME').sum()

# –ó–Ω–∞—Ö–æ–¥–∏–º–æ –º—ñ—Å—è—Ü—å –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é —Å—É–º–æ—é –∑–Ω–∞—á–µ–Ω—å
most_popular_month = monthly_data.sum(axis=1).idxmax()
most_popular_month_value = monthly_data.sum(axis=1).max()

# –û—Ç—Ä–∏–º—É—î–º–æ –Ω–∞–∑–≤—É –º—ñ—Å—è—Ü—è
month_name = most_popular_month.strftime("%B")

# –í–∏–≤–æ–¥–∏–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
print("\n–†–µ–∑—É–ª—å—Ç–∞—Ç:")
print(f"üö¥–ù–∞–π–±—ñ–ª—å—à –ø–æ–ø—É–ª—è—Ä–Ω–∏–π –º—ñ—Å—è—Ü—å: {month_name} –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—å—é –ø–æ—ó–∑–¥–æ–∫: {most_popular_month_value}")
